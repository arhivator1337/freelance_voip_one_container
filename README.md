#Краткое описание: 

контейнер asterisk содержит в себе php,memcached,nginx,asterisk,fail2ban
контейнер mysql содержит в себе Бд.


#How To:

для того что бы все работало верно порты указаные в docker-compose 
должны быть свободны и совпадать с настройками в asterisk

главные файлы для настройки ./asterisk/ - 
конфигурация asterisk:
( изменения res_odbc.conf ( для соединение с БД ) должны совпадать с /etc/odbc.ini ! )
( изменения в sip.conf ( в частности  externaddr =должен меняться на внешний ип сервера: 
порт на котором слушает asterisk ) nat настройки так же должны присутствовать для каждого пира.
( изменения в rtp.conf ( если нужно увеличить количество портов по умолчанию их количество с 10000 до 10200 
что равно количеству на 100 одновременных звонков )
если нужно больше то для увеличения нужно менять rtp.conf 
и docker-compose.yaml рендж портов должен совпадать !

конфигурация nginx:
./nginx.conf - содержит базовую конфигурацию nginx'a
./nginx/conf.d/ - содержит дополнительную конфигурацию ( виртуал хосты )

конфигурация php-fpm: 
./php-fpm.d/ - содержит конфигурацию пулов 
./php.ini - базовые настройки php.ini

использование и базовые команды:

docker exec -it asterisk asterisk -rx 'odbc show' - показать состояние соединения с бд
docker exec -it asterisk bash - войти внутрь контейнера оттуда можно использовать стандартные команды.

docker exec -it asterisk asterisk -rx 'core restart now' - пример использования рестарта не проваливаясь вовнутрь контейнера.

docker exec -it mysql mysql -u root -p  - доступ в базу данных

если нам нужно по какой либо причине перезагрузить весь контейнер : 

docker ps | grep имя контейнера( asterisk/mysql )


данные mysql храняться в ./mysql по умолчанию этой папки нету ! если нужен полный редеплой то нужно сделать rm -rf ./mysql


для старта : 
1) docker-compose up
2) после старта всех компонентов Ctrl+C
3) docker-compose start


для остановки: 
docker-compose stop
